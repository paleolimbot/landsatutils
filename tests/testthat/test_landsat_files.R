
context("filename parsing")

product_ids <- c("LC08_L1TP_009029_20170508_20170515_01_T1", # These are from the SW Nova dataset
                 "LC08_L1GT_009029_20170422_20170501_01_T2",
                 "LC08_L1GT_009029_20170406_20170414_01_T2",
                 "LC08_L1TP_009029_20170321_20170329_01_T1",
                 "LC08_L1GT_009029_20170217_20170228_01_T2",
                 "LC08_L1GT_009029_20170201_20170215_01_T2",
                 "LC08_L1TP_009029_20170116_20170311_01_T1",
                 "LC08_L1TP_009029_20161231_20170314_01_T1",
                 "LC08_L1GT_009029_20161215_20170316_01_T2",
                 "LC08_L1TP_009029_20161129_20170317_01_T1",
                 "LC08_L1TP_009029_20161113_20170318_01_T1",
                 "LC08_L1GT_009029_20161028_20170319_01_T2",
                 "LC08_L1TP_009029_20161012_20170319_01_T1",
                 "LC08_L1TP_009029_20160926_20170319_01_T1",
                 "LC08_L1TP_009029_20160910_20170321_01_T1",
                 "LC08_L1TP_009029_20160825_20170322_01_T1",
                 "LC08_L1TP_009029_20160809_20170322_01_T1",
                 "LC08_L1TP_009029_20160724_20170322_01_T1",
                 "LC08_L1GT_009029_20160708_20170323_01_T2",
                 "LC08_L1TP_009029_20160622_20170323_01_T1",
                 "LC08_L1GT_009029_20160606_20170324_01_T2",
                 "LC08_L1TP_009029_20160521_20170324_01_T1",
                 "LC08_L1GT_009029_20160505_20170325_01_T2",
                 "LC08_L1TP_009029_20160419_20170326_01_T1",
                 "LC08_L1GT_009029_20160403_20170327_01_T2",
                 "LC08_L1TP_009029_20160318_20170328_01_T1",
                 "LC08_L1GT_009029_20160302_20170328_01_T2",
                 "LC08_L1TP_009029_20160215_20170329_01_T1",
                 "LC08_L1TP_009029_20160130_20170330_01_T1",
                 "LC08_L1TP_009029_20160114_20170405_01_T1",
                 "LC08_L1GT_009029_20151229_20170331_01_T2",
                 "LC08_L1TP_009029_20151213_20170401_01_T1",
                 "LC08_L1TP_009029_20151127_20170401_01_T1",
                 "LC08_L1GT_009029_20151111_20170402_01_T2",
                 "LC08_L1TP_009029_20151026_20170402_01_T1",
                 "LC08_L1TP_009029_20151010_20170403_01_T1",
                 "LC08_L1TP_009029_20150924_20170403_01_T1",
                 "LC08_L1TP_009029_20150908_20170404_01_T1",
                 "LC08_L1TP_009029_20150823_20170405_01_T1",
                 "LC08_L1TP_009029_20150807_20170406_01_T1",
                 "LC08_L1GT_009029_20150722_20170406_01_T2",
                 "LC08_L1TP_009029_20150706_20170407_01_T1",
                 "LC08_L1TP_009029_20150620_20170407_01_T1",
                 "LC08_L1TP_009029_20150604_20170408_01_T1",
                 "LC08_L1TP_009029_20150519_20170408_01_T1",
                 "LC08_L1TP_009029_20150503_20170409_01_T1",
                 "LC08_L1TP_009029_20150417_20170409_01_T1",
                 "LC08_L1TP_009029_20150401_20170411_01_T1",
                 "LC08_L1GT_009029_20150316_20170412_01_T2",
                 "LC08_L1TP_009029_20150228_20170412_01_T1",
                 "LC08_L1TP_009029_20150212_20170413_01_T1",
                 "LC08_L1GT_009029_20150127_20170413_01_T2",
                 "LC08_L1TP_009029_20150111_20170415_01_T1",
                 "LC08_L1TP_009029_20141226_20170415_01_T1",
                 "LC08_L1GT_009029_20141210_20170416_01_T2",
                 "LC08_L1GT_009029_20141124_20170417_01_T2",
                 "LC08_L1TP_009029_20141108_20170417_01_T1",
                 "LC08_L1GT_009029_20141023_20170418_01_T2",
                 "LC08_L1TP_009029_20141007_20170418_01_T1",
                 "LC08_L1TP_009029_20140921_20170419_01_T1",
                 "LC08_L1TP_009029_20140905_20170419_01_T1",
                 "LC08_L1TP_009029_20140820_20170420_01_T1",
                 "LC08_L1TP_009029_20140804_20170420_01_T1",
                 "LC08_L1TP_009029_20140719_20170421_01_T1",
                 "LC08_L1GT_009029_20140703_20170421_01_T2",
                 "LC08_L1TP_009029_20140617_20170421_01_T1",
                 "LC08_L1TP_009029_20140601_20170422_01_T1",
                 "LC08_L1TP_009029_20140516_20170422_01_T1",
                 "LC08_L1TP_009029_20140414_20170423_01_T1",
                 "LC08_L1TP_009029_20140329_20170424_01_T1",
                 "LC08_L1GT_009029_20140313_20170425_01_T2",
                 "LC08_L1TP_009029_20140225_20170425_01_T1",
                 "LC08_L1TP_009029_20140209_20170426_01_T1",
                 "LC08_L1TP_009029_20140124_20170426_01_T1",
                 "LC08_L1TP_009029_20140108_20170426_01_T1",
                 "LC08_L1GT_009029_20131207_20170428_01_T2",
                 "LC08_L1TP_009029_20131121_20170428_01_T1",
                 "LC08_L1TP_009029_20131105_20170428_01_T1",
                 "LC08_L1TP_009029_20130918_20170502_01_T1",
                 "LC08_L1TP_009029_20130817_20170502_01_T1",
                 "LC08_L1TP_009029_20130801_20170503_01_T1",
                 "LC08_L1TP_009029_20130716_20170503_01_T1",
                 "LC08_L1GT_009029_20130614_20170503_01_T2",
                 "LC08_L1TP_009029_20130513_20170504_01_T1",
                 "LC08_L1TP_009029_20130427_20170505_01_T1",
                 "LC08_L1TP_009029_20130411_20170505_01_T1",
                 "LO08_L1TP_008029_20130406_20170505_01_T1",
                 "LC08_L1GT_009029_20130401_20170505_01_T2",
                 "LC08_L1GT_010029_20130327_20170310_01_T2",
                 "LT08_L1GT_008029_20130314_20170505_01_T2",
                 "LE07_L1TP_009029_20170516_20170516_01_RT",
                 "LE07_L1TP_009029_20170430_20170430_01_RT",
                 "LE07_L1TP_009029_20170414_20170510_01_T1",
                 "LE07_L1GT_009029_20170329_20170424_01_T2",
                 "LE07_L1TP_009029_20170313_20170408_01_T1",
                 "LE07_L1TP_009029_20170225_20170323_01_T1",
                 "LE07_L1TP_009029_20170209_20170307_01_T1",
                 "LE07_L1GT_009029_20170124_20170221_01_T2",
                 "LE07_L1TP_009029_20170108_20170203_01_T1",
                 "LE07_L1TP_009029_20161223_20170213_01_T2",
                 "LE07_L1TP_009029_20161207_20170128_01_T1",
                 "LE07_L1GT_009029_20161121_20170112_01_T2",
                 "LE07_L1TP_009029_20161105_20161201_01_T1",
                 "LE07_L1TP_009029_20161020_20161115_01_T1",
                 "LE07_L1TP_009029_20161004_20161030_01_T1",
                 "LE07_L1TP_009029_20160918_20161014_01_T1",
                 "LE07_L1TP_009029_20160902_20161006_01_T1",
                 "LE07_L1GT_009029_20160817_20161007_01_T2",
                 "LE07_L1TP_009029_20160801_20161008_01_T1",
                 "LE07_L1TP_009029_20160716_20161009_01_T1",
                 "LE07_L1GT_009029_20160630_20161208_01_T2",
                 "LE07_L1GT_009029_20160614_20161210_01_T2",
                 "LE07_L1TP_009029_20160529_20161010_01_T1",
                 "LE07_L1TP_009029_20160513_20161011_01_T1",
                 "LE07_L1TP_009029_20160427_20161012_01_T1",
                 "LE07_L1GT_009029_20160411_20161012_01_T2",
                 "LE07_L1GT_009029_20160326_20161013_01_T2",
                 "LE07_L1GT_009029_20160310_20161014_01_T2",
                 "LE07_L1TP_009029_20160223_20161014_01_T1",
                 "LE07_L1TP_009029_20160207_20161015_01_T1",
                 "LE07_L1TP_009029_20160122_20161016_01_T1",
                 "LE07_L1TP_009029_20160106_20161016_01_T1",
                 "LE07_L1TP_009029_20151221_20161016_01_T1",
                 "LE07_L1TP_009029_20151205_20161017_01_T1",
                 "LE07_L1TP_009029_20151119_20161017_01_T2",
                 "LE07_L1GT_009029_20151103_20161017_01_T2",
                 "LE07_L1TP_009029_20151018_20161023_01_T1",
                 "LE07_L1GT_009029_20151002_20161019_01_T2",
                 "LE07_L1TP_009029_20150916_20161020_01_T1",
                 "LE07_L1TP_009029_20150831_20161021_01_T1",
                 "LE07_L1TP_009029_20150815_20161022_01_T1",
                 "LE07_L1TP_009029_20150730_20161023_01_T1",
                 "LE07_L1TP_009029_20150714_20161023_01_T1",
                 "LE07_L1GT_009029_20150628_20161024_01_T2",
                 "LE07_L1TP_009029_20150612_20161025_01_T1",
                 "LE07_L1TP_009029_20150527_20161026_01_T1",
                 "LE07_L1GT_009029_20150511_20161026_01_T2",
                 "LE07_L1TP_009029_20150425_20161029_01_T1",
                 "LE07_L1TP_009029_20150409_20161029_01_T1",
                 "LE07_L1TP_009029_20150324_20161028_01_T1",
                 "LE07_L1TP_009029_20150308_20161028_01_T1",
                 "LE07_L1TP_009029_20150220_20161029_01_T1",
                 "LE07_L1TP_009029_20150204_20161029_01_T1",
                 "LE07_L1GT_009029_20150119_20161029_01_T2",
                 "LE07_L1TP_009029_20150103_20161030_01_T1",
                 "LE07_L1GT_009029_20141218_20161030_01_T2",
                 "LE07_L1TP_009029_20141202_20161031_01_T1",
                 "LE07_L1TP_009029_20141116_20161031_01_T1",
                 "LE07_L1TP_009029_20141031_20161101_01_T1",
                 "LE07_L1TP_009029_20141015_20161101_01_T1",
                 "LE07_L1TP_009029_20140913_20161110_01_T1",
                 "LE07_L1TP_009029_20140828_20161111_01_T1",
                 "LE07_L1TP_009029_20140812_20161113_01_T1",
                 "LE07_L1TP_009029_20140727_20161111_01_T1",
                 "LE07_L1TP_009029_20140711_20161112_01_T1",
                 "LE07_L1TP_009029_20140625_20161113_01_T1",
                 "LE07_L1TP_009029_20140609_20161114_01_T1",
                 "LE07_L1GT_009029_20140524_20161115_01_T2",
                 "LE07_L1TP_009029_20140508_20161115_01_T1",
                 "LE07_L1TP_009029_20140422_20161116_01_T1",
                 "LE07_L1TP_009029_20140406_20161116_01_T1",
                 "LE07_L1TP_009029_20140321_20161117_01_T1",
                 "LE07_L1TP_009029_20140305_20161117_01_T1",
                 "LE07_L1TP_009029_20140217_20161117_01_T1",
                 "LE07_L1TP_009029_20140201_20161118_01_T1",
                 "LE07_L1GT_009029_20140116_20161118_01_T2",
                 "LE07_L1TP_009029_20131231_20161118_01_T2",
                 "LE07_L1GT_009029_20131215_20161119_01_T2",
                 "LE07_L1TP_009029_20131129_20161119_01_T1",
                 "LE07_L1GT_009029_20131113_20161119_01_T2",
                 "LE07_L1TP_009029_20131028_20161120_01_T1",
                 "LE07_L1TP_009029_20131012_20161120_01_T1",
                 "LE07_L1TP_009029_20130910_20161121_01_T1",
                 "LE07_L1TP_009029_20130825_20161122_01_T1",
                 "LE07_L1TP_009029_20130606_20161123_01_T1",
                 "LE07_L1GT_009029_20130521_20161123_01_T2",
                 "LE07_L1TP_009029_20130505_20161124_01_T1",
                 "LE07_L1TP_009029_20130318_20161125_01_T1",
                 "LE07_L1TP_009029_20130129_20161126_01_T1",
                 "LE07_L1TP_009029_20121212_20161126_01_T1",
                 "LE07_L1TP_009029_20121126_20161128_01_T1",
                 "LE07_L1TP_009029_20121110_20161127_01_T1",
                 "LE07_L1TP_009029_20121025_20161129_01_T1",
                 "LE07_L1TP_009029_20120923_20161128_01_T1",
                 "LE07_L1TP_009029_20120907_20161129_01_T1",
                 "LE07_L1TP_009029_20120822_20161129_01_T1",
                 "LE07_L1GT_009029_20120806_20161129_01_T2",
                 "LE07_L1TP_009029_20120721_20161130_01_T1",
                 "LE07_L1GT_009029_20120705_20161201_01_T2",
                 "LE07_L1TP_009029_20120619_20161130_01_T1",
                 "LE07_L1GT_009029_20120603_20161201_01_T2",
                 "LE07_L1TP_009029_20120518_20161201_01_T1",
                 "LE07_L1GT_009029_20120502_20161202_01_T2",
                 "LE07_L1TP_009029_20120416_20161202_01_T1",
                 "LE07_L1TP_009029_20120331_20161202_01_T1",
                 "LE07_L1TP_009029_20120212_20161203_01_T1",
                 "LE07_L1TP_009029_20120111_20161203_01_T1",
                 "LE07_L1TP_009029_20111226_20161204_01_T2",
                 "LE07_L1TP_009029_20111108_20161205_01_T1",
                 "LE07_L1TP_009029_20111023_20161205_01_T1",
                 "LE07_L1TP_009029_20111007_20161206_01_T1",
                 "LE07_L1TP_009029_20110921_20161206_01_T1",
                 "LE07_L1TP_009029_20110905_20161206_01_T1",
                 "LE07_L1TP_009029_20110820_20161206_01_T1",
                 "LE07_L1GT_009029_20110804_20161207_01_T2",
                 "LE07_L1TP_009029_20110719_20161207_01_T1",
                 "LE07_L1TP_009029_20110703_20161208_01_T1",
                 "LE07_L1TP_009029_20110601_20161209_01_T1",
                 "LE07_L1TP_009029_20110430_20161209_01_T1",
                 "LE07_L1GT_009029_20110414_20161209_01_T2",
                 "LE07_L1TP_009029_20110329_20161209_01_T1",
                 "LE07_L1TP_009029_20110313_20161209_01_T1",
                 "LE07_L1TP_009029_20110209_20161210_01_T1",
                 "LE07_L1TP_009029_20110124_20161210_01_T1",
                 "LE07_L1TP_009029_20101121_20161212_01_T1",
                 "LE07_L1TP_009029_20101020_20161212_01_T1",
                 "LE07_L1TP_009029_20101004_20161212_01_T1",
                 "LE07_L1TP_009029_20100918_20161212_01_T1",
                 "LE07_L1TP_009029_20100902_20161212_01_T1",
                 "LE07_L1TP_009029_20100801_20161213_01_T1",
                 "LE07_L1TP_009029_20100716_20161214_01_T1",
                 "LE07_L1TP_009029_20100630_20161214_01_T1",
                 "LE07_L1TP_009029_20100614_20161214_01_T1",
                 "LE07_L1TP_009029_20100529_20161214_01_T1",
                 "LE07_L1TP_009029_20100513_20161215_01_T1",
                 "LE07_L1TP_009029_20100411_20161215_01_T1",
                 "LE07_L1TP_009029_20100310_20161215_01_T1",
                 "LE07_L1TP_009029_20091204_20161216_01_T1",
                 "LE07_L1TP_009029_20091118_20161219_01_T1",
                 "LE07_L1TP_009029_20091102_20161217_01_T1",
                 "LE07_L1TP_009029_20091017_20161217_01_T1",
                 "LE07_L1TP_009029_20091001_20161217_01_T2",
                 "LE07_L1TP_009029_20090915_20161217_01_T1",
                 "LE07_L1TP_009029_20090814_20161218_01_T1",
                 "LE07_L1TP_009029_20090729_20161218_01_T1",
                 "LE07_L1TP_009029_20090713_20161219_01_T1",
                 "LE07_L1GT_009029_20090627_20161219_01_T2",
                 "LE07_L1TP_009029_20090526_20161220_01_T1",
                 "LE07_L1TP_009029_20090408_20161220_01_T1",
                 "LE07_L1TP_009029_20090323_20161221_01_T1",
                 "LE07_L1TP_009029_20090307_20161222_01_T1",
                 "LE07_L1TP_009029_20090102_20161223_01_T1",
                 "LE07_L1GT_009029_20081030_20161224_01_T2",
                 "LE07_L1TP_009029_20081014_20161224_01_T1",
                 "LE07_L1TP_009029_20080827_20161225_01_T1",
                 "LE07_L1TP_009029_20080726_20161228_01_T1",
                 "LE07_L1TP_009029_20080507_20161229_01_T1",
                 "LE07_L1TP_009029_20080421_20161229_01_T1",
                 "LE07_L1TP_009029_20080217_20161230_01_T1",
                 "LE07_L1TP_009029_20080201_20161231_01_T1",
                 "LE07_L1TP_009029_20071215_20161231_01_T1",
                 "LE07_L1TP_009029_20071028_20170102_01_T1",
                 "LE07_L1TP_009029_20070926_20170101_01_T1",
                 "LE07_L1GT_009029_20070910_20170101_01_T2",
                 "LE07_L1TP_009029_20070825_20170101_01_T1",
                 "LE07_L1TP_009029_20070809_20170102_01_T1",
                 "LE07_L1GT_009029_20070724_20170103_01_T2",
                 "LE07_L1TP_009029_20070606_20170103_01_T1",
                 "LE07_L1TP_009029_20061228_20170105_01_T1",
                 "LE07_L1TP_009029_20061212_20170106_01_T1",
                 "LE07_L1GT_009029_20061126_20170107_01_T2",
                 "LE07_L1TP_009029_20061110_20170107_01_T1",
                 "LE07_L1TP_009029_20061009_20170108_01_T1",
                 "LE07_L1TP_009029_20060907_20170107_01_T1",
                 "LE07_L1TP_009029_20060822_20170107_01_T1",
                 "LE07_L1TP_009029_20060806_20170109_01_T1",
                 "LE07_L1GT_009029_20060619_20170108_01_T2",
                 "LE07_L1TP_009029_20060518_20170109_01_T1",
                 "LE07_L1GT_009029_20060416_20170110_01_T2",
                 "LE07_L1TP_009029_20060315_20170110_01_T1",
                 "LE07_L1TP_009029_20060211_20170111_01_T1",
                 "LE07_L1TP_009029_20060110_20170111_01_T1",
                 "LE07_L1GT_009029_20051123_20170112_01_T2",
                 "LE07_L1TP_009029_20051107_20170112_01_T1",
                 "LE07_L1TP_009029_20051022_20170113_01_T1",
                 "LE07_L1TP_009029_20050904_20170114_01_T1",
                 "LE07_L1TP_009029_20050819_20170113_01_T1",
                 "LE07_L1TP_009029_20050803_20170113_01_T1",
                 "LE07_L1TP_009029_20050429_20170116_01_T1",
                 "LE07_L1TP_009029_20050413_20170116_01_T1",
                 "LE07_L1TP_009029_20050328_20170115_01_T1",
                 "LE07_L1TP_009029_20050224_20170117_01_T1",
                 "LE07_L1TP_009029_20050208_20170116_01_T1",
                 "LE07_L1TP_009029_20041222_20170116_01_T1",
                 "LE07_L1TP_009029_20041206_20170117_01_T1",
                 "LE07_L1TP_009029_20041120_20170117_01_T1",
                 "LE07_L1TP_009029_20041104_20170118_01_T1",
                 "LE07_L1TP_009029_20041019_20170118_01_T1",
                 "LE07_L1TP_009029_20040901_20170119_01_T1",
                 "LE07_L1TP_009029_20040731_20170119_01_T1",
                 "LE07_L1GT_009029_20040629_20170121_01_T2",
                 "LE07_L1TP_009029_20040613_20170121_01_T1",
                 "LE07_L1GT_009029_20040528_20170120_01_T2",
                 "LE07_L1GT_009029_20040426_20170121_01_T2",
                 "LE07_L1TP_009029_20040410_20170121_01_T1",
                 "LE07_L1TP_009029_20040325_20170122_01_T1",
                 "LE07_L1TP_009029_20040309_20170122_01_T1",
                 "LE07_L1TP_009029_20040206_20170123_01_T1",
                 "LE07_L1TP_009029_20031118_20170123_01_T1",
                 "LE07_L1TP_009029_20031017_20170123_01_T1",
                 "LE07_L1TP_009029_20031001_20170123_01_T1",
                 "LE07_L1TP_009029_20030814_20170124_01_T1",
                 "LE07_L1TP_009029_20030526_20170125_01_T2",
                 "LE07_L1GT_009029_20030510_20170125_01_T2",
                 "LE07_L1TP_009029_20030424_20170126_01_T1",
                 "LE07_L1TP_009029_20030408_20170125_01_T1",
                 "LE07_L1TP_009029_20030307_20170126_01_T1",
                 "LE07_L1TP_009029_20030118_20170126_01_T1",
                 "LE07_L1TP_009029_20021115_20170129_01_T1",
                 "LE07_L1TP_009029_20021030_20170127_01_T1",
                 "LE07_L1TP_009029_20021014_20170128_01_T1",
                 "LE07_L1TP_009029_20020928_20170129_01_T1",
                 "LE07_L1TP_009029_20020912_20170128_01_T1",
                 "LE07_L1TP_009029_20020827_20170129_01_T1",
                 "LE07_L1TP_009029_20020811_20170128_01_T1",
                 "LE07_L1TP_009029_20020726_20170128_01_T1",
                 "LE07_L1TP_009029_20020710_20170129_01_T1",
                 "LE07_L1TP_009029_20020624_20170129_01_T1",
                 "LE07_L1TP_009029_20020608_20170130_01_T1",
                 "LE07_L1TP_009029_20020523_20170130_01_T1",
                 "LE07_L1TP_009029_20020507_20170130_01_T1",
                 "LE07_L1TP_009029_20020421_20170130_01_T1",
                 "LE07_L1TP_009029_20020405_20170131_01_T1",
                 "LE07_L1TP_009029_20020320_20170131_01_T1",
                 "LE07_L1TP_009029_20020304_20170131_01_T1",
                 "LE07_L1TP_009029_20011230_20170201_01_T1",
                 "LE07_L1TP_009029_20011214_20170202_01_T1",
                 "LE07_L1TP_009029_20011112_20170202_01_T1",
                 "LE07_L1TP_009029_20011027_20170202_01_T1",
                 "LE07_L1GT_009029_20010925_20170203_01_T2",
                 "LE07_L1TP_009029_20010909_20170203_01_T1",
                 "LE07_L1TP_009029_20010824_20170203_01_T1",
                 "LE07_L1TP_009029_20010808_20170204_01_T1",
                 "LE07_L1TP_009029_20010723_20170204_01_T1",
                 "LE07_L1TP_009029_20010707_20170204_01_T1",
                 "LE07_L1TP_009029_20010621_20170204_01_T1",
                 "LE07_L1TP_009029_20010605_20170205_01_T1",
                 "LE07_L1TP_009029_20010504_20170205_01_T1",
                 "LE07_L1GT_009029_20010418_20170205_01_T2",
                 "LE07_L1TP_009029_20010301_20170206_01_T1",
                 "LE07_L1TP_009029_20001125_20170209_01_T1",
                 "LE07_L1TP_009029_20001024_20170209_01_T1",
                 "LE07_L1TP_009029_20001008_20170209_01_T1",
                 "LE07_L1TP_009029_20000922_20170209_01_T1",
                 "LE07_L1TP_009029_20000906_20170210_01_T1",
                 "LE07_L1TP_009029_20000821_20170210_01_T1",
                 "LE07_L1TP_009029_20000805_20170210_01_T1",
                 "LE07_L1TP_009029_20000720_20170210_01_T1",
                 "LE07_L1TP_009029_20000618_20170211_01_T1",
                 "LE07_L1TP_009029_20000602_20170211_01_T1",
                 "LE07_L1TP_009029_20000517_20170211_01_T1",
                 "LE07_L1TP_009029_20000501_20170212_01_T1",
                 "LE07_L1TP_009029_20000415_20170212_01_T1",
                 "LE07_L1TP_009029_20000314_20170213_01_T1",
                 "LE07_L1GT_009029_20000211_20170213_01_T2",
                 "LE07_L1TP_009029_20000110_20170215_01_T1",
                 "LE07_L1TP_009029_19991209_20170215_01_T1",
                 "LE07_L1TP_009029_19991123_20170216_01_T1",
                 "LE07_L1TP_009029_19991006_20170216_01_T1",
                 "LE07_L1TP_009029_19990920_20170217_01_T1",
                 "LE07_L1TP_009029_19990904_20170217_01_T1",
                 "LE07_L1TP_009029_19990803_20170218_01_T1",
                 "LE07_L1TP_009029_19990718_20170218_01_T1",
                 "LE07_L1TP_009029_19990702_20170218_01_T1",
                 "LT05_L1TP_009029_20111031_20161005_01_T1",
                 "LT05_L1TP_009029_20111015_20161005_01_T1",
                 "LT05_L1TP_009029_20110711_20161009_01_T1",
                 "LT05_L1TP_009029_20110422_20161209_01_T1",
                 "LT05_L1TP_009029_20110406_20161209_01_T1",
                 "LT05_L1TP_009029_20110217_20161010_01_T1",
                 "LT05_L1TP_009029_20101231_20161011_01_T1",
                 "LT05_L1TP_009029_20101129_20161012_01_T1",
                 "LT05_L1TP_009029_20101113_20161012_01_T1",
                 "LT05_L1TP_009029_20101028_20161012_01_T1",
                 "LT05_L1TP_009029_20101012_20161012_01_T1",
                 "LT05_L1TP_009029_20100622_20161015_01_T1",
                 "LT05_L1TP_009029_20100505_20161017_01_T1",
                 "LT05_L1GS_009029_20100419_20161015_01_T2",
                 "LT05_L1GS_009029_20100302_20161016_01_T2",
                 "LT05_L1GS_009029_20100214_20161016_01_T2",
                 "LT05_L1GS_009029_20100129_20161017_01_T2",
                 "LT05_L1TP_009029_20100113_20161017_01_T1",
                 "LT05_L1GS_009029_20091126_20161017_01_T2",
                 "LT05_L1TP_009029_20091110_20161018_01_T1",
                 "LT05_L1TP_009029_20091025_20161019_01_T1",
                 "LT05_L1TP_009029_20091009_20161019_01_T1",
                 "LT05_L1TP_009029_20090923_20161025_01_T1",
                 "LT05_L1TP_009029_20090907_20161021_01_T1",
                 "LT05_L1TP_009029_20090822_20161021_01_T1",
                 "LT05_L1TP_009029_20090806_20161022_01_T1",
                 "LT05_L1GS_009029_20090721_20161023_01_T2",
                 "LT05_L1TP_009029_20090705_20161024_01_T1",
                 "LT05_L1TP_009029_20090619_20161025_01_T1",
                 "LT05_L1TP_009029_20090603_20161025_01_T1",
                 "LT05_L1GS_009029_20090518_20161028_01_T2",
                 "LT05_L1GS_009029_20090502_20161026_01_T2",
                 "LT05_L1TP_009029_20090416_20161026_01_T1",
                 "LT05_L1GS_009029_20090331_20161027_01_T2",
                 "LT05_L1TP_009029_20090315_20161027_01_T1",
                 "LT05_L1GS_009029_20090227_20161029_01_T2",
                 "LT05_L1GS_009029_20090211_20161028_01_T2",
                 "LT05_L1TP_009029_20090126_20161028_01_T1",
                 "LT05_L1TP_009029_20081006_20161029_01_T1",
                 "LT05_L1TP_009029_20080920_20161029_01_T1",
                 "LT05_L1TP_009029_20080904_20161029_01_T1",
                 "LT05_L1GS_009029_20080819_20161030_01_T2",
                 "LT05_L1GS_009029_20080803_20161030_01_T2",
                 "LT05_L1TP_009029_20080718_20161030_01_T1",
                 "LT05_L1TP_009029_20080702_20161030_01_T1",
                 "LT05_L1TP_009029_20080616_20161031_01_T1",
                 "LT05_L1GS_009029_20080531_20161031_01_T2",
                 "LT05_L1TP_009029_20080515_20161031_01_T1",
                 "LT05_L1GS_009029_20080429_20161101_01_T2",
                 "LT05_L1GS_009029_20080413_20161101_01_T2",
                 "LT05_L1GS_009029_20080328_20161101_01_T2",
                 "LT05_L1TP_009029_20080312_20161101_01_T1",
                 "LT05_L1TP_009029_20080225_20161101_01_T1",
                 "LT05_L1TP_009029_20071004_20161112_01_T1",
                 "LT05_L1TP_009029_20070918_20161111_01_T1",
                 "LT05_L1TP_009029_20070902_20161112_01_T1",
                 "LT05_L1GS_009029_20070817_20161111_01_T2",
                 "LT05_L1TP_009029_20070801_20161112_01_T1",
                 "LT05_L1TP_009029_20070716_20161113_01_T1",
                 "LT05_L1TP_009029_20070630_20161113_01_T1",
                 "LT05_L1GS_009029_20070614_20161112_01_T2",
                 "LT05_L1TP_009029_20070529_20161114_01_T1",
                 "LT05_L1TP_009029_20070513_20161115_01_T1",
                 "LT05_L1GS_009029_20070427_20161115_01_T2",
                 "LT05_L1TP_009029_20070411_20161115_01_T1",
                 "LT05_L1TP_009029_20070326_20161116_01_T1",
                 "LT05_L1GS_009029_20070310_20161116_01_T2",
                 "LT05_L1TP_009029_20070222_20161116_01_T1",
                 "LT05_L1TP_009029_20070206_20161117_01_T1",
                 "LT05_L1TP_009029_20070121_20161117_01_T1",
                 "LT05_L1TP_009029_20070105_20161117_01_T1",
                 "LT05_L1TP_009029_20061220_20161117_01_T1",
                 "LT05_L1GS_009029_20061204_20161117_01_T2",
                 "LT05_L1TP_009029_20061118_20161117_01_T1",
                 "LT05_L1GS_009029_20061102_20161118_01_T2",
                 "LT05_L1TP_009029_20061017_20161118_01_T1",
                 "LT05_L1TP_009029_20061001_20161119_01_T1",
                 "LT05_L1TP_009029_20060915_20161119_01_T1",
                 "LT05_L1TP_009029_20060830_20161119_01_T1",
                 "LT05_L1TP_009029_20060814_20161119_01_T1",
                 "LT05_L1TP_009029_20060729_20161120_01_T1",
                 "LT05_L1GS_009029_20060713_20161120_01_T2",
                 "LT05_L1GS_009029_20060627_20161121_01_T2",
                 "LT05_L1GS_009029_20060611_20161121_01_T2",
                 "LT05_L1TP_009029_20060526_20161121_01_T1",
                 "LT05_L1GS_009029_20060510_20161122_01_T2",
                 "LT05_L1GS_009029_20060424_20161122_01_T2",
                 "LT05_L1GS_009029_20060408_20161123_01_T2",
                 "LT05_L1TP_009029_20060307_20161122_01_T1",
                 "LT05_L1TP_009029_20060219_20161123_01_T1",
                 "LT05_L1GS_009029_20060203_20161123_01_T2",
                 "LT05_L1GS_009029_20060118_20161123_01_T2",
                 "LT05_L1TP_009029_20051115_20161123_01_T1",
                 "LT05_L1TP_009029_20051030_20161123_01_T1",
                 "LT05_L1GS_009029_20051014_20161124_01_T2",
                 "LT05_L1TP_009029_20050928_20161124_01_T1",
                 "LT05_L1TP_009029_20050912_20161124_01_T1",
                 "LT05_L1TP_009029_20050827_20161125_01_T1",
                 "LT05_L1TP_009029_20050811_20161124_01_T1",
                 "LT05_L1TP_009029_20050726_20161125_01_T1",
                 "LT05_L1GS_009029_20050710_20161126_01_T2",
                 "LT05_L1TP_009029_20050624_20161126_01_T1",
                 "LT05_L1TP_009029_20050608_20161127_01_T1",
                 "LT05_L1GS_009029_20050523_20161126_01_T2",
                 "LT05_L1GS_009029_20050507_20161126_01_T2",
                 "LT05_L1TP_009029_20050421_20161127_01_T1",
                 "LT05_L1TP_009029_20050405_20161126_01_T1",
                 "LT05_L1TP_009029_20050320_20161128_01_T1",
                 "LT05_L1TP_009029_20050304_20161127_01_T1",
                 "LT05_L1GS_009029_20050216_20161128_01_T2",
                 "LT05_L1TP_009029_20050131_20161128_01_T1",
                 "LT05_L1TP_009029_20050115_20161127_01_T1",
                 "LT05_L1TP_009029_20041230_20161127_01_T1",
                 "LT05_L1GS_009029_20041214_20161127_01_T2",
                 "LT05_L1TP_009029_20041128_20161128_01_T1",
                 "LT05_L1TP_009029_20041112_20161128_01_T1",
                 "LT05_L1TP_009029_20041027_20161128_01_T1",
                 "LT05_L1GS_009029_20041011_20161129_01_T2",
                 "LT05_L1TP_009029_20040925_20161129_01_T1",
                 "LT05_L1GS_009029_20040909_20161129_01_T2",
                 "LT05_L1TP_009029_20040824_20161129_01_T1",
                 "LT05_L1TP_009029_20040808_20161130_01_T1",
                 "LT05_L1GS_009029_20040723_20161130_01_T2",
                 "LT05_L1TP_009029_20040707_20161130_01_T1",
                 "LT05_L1TP_009029_20040621_20161130_01_T1",
                 "LT05_L1TP_009029_20040605_20161201_01_T1",
                 "LT05_L1TP_009029_20040520_20161202_01_T1",
                 "LT05_L1GS_009029_20040504_20161201_01_T2",
                 "LT05_L1TP_009029_20040418_20161202_01_T1",
                 "LT05_L1GS_009029_20040402_20161202_01_T2",
                 "LT05_L1TP_009029_20040301_20161203_01_T1",
                 "LT05_L1TP_009029_20040214_20161203_01_T1",
                 "LT05_L1GS_009029_20040129_20161202_01_T2",
                 "LT05_L1GS_009029_20040113_20161202_01_T2",
                 "LT05_L1TP_009029_20031228_20161203_01_T1",
                 "LT05_L1GS_009029_20031212_20161203_01_T2",
                 "LT05_L1TP_009029_20031126_20161203_01_T1",
                 "LT05_L1TP_009029_20031110_20161203_01_T1",
                 "LT05_L1TP_009029_20031025_20161203_01_T1",
                 "LT05_L1TP_009029_20031009_20161203_01_T1",
                 "LT05_L1GS_009029_20030923_20161204_01_T2",
                 "LT05_L1TP_009029_20030907_20161204_01_T1",
                 "LT05_L1TP_009029_20030822_20161204_01_T1",
                 "LT05_L1GS_009029_20030806_20161205_01_T2",
                 "LT05_L1TP_009029_20030721_20161205_01_T1",
                 "LT05_L1TP_009029_20030705_20161205_01_T1",
                 "LT05_L1GS_009029_20030619_20161205_01_T2",
                 "LT05_L1TP_009029_20030603_20161206_01_T1",
                 "LT05_L1TP_009029_20030518_20161206_01_T1",
                 "LT05_L1GS_009029_20030502_20161206_01_T2",
                 "LT05_L1TP_009029_20030416_20161206_01_T1",
                 "LT05_L1GS_009029_20030331_20161206_01_T2",
                 "LT05_L1TP_009029_20030315_20161206_01_T1",
                 "LT05_L1TP_009029_20030227_20161206_01_T1",
                 "LT05_L1GS_009029_20030211_20161206_01_T2",
                 "LT05_L1GS_009029_20030126_20161206_01_T2",
                 "LT05_L1GS_009029_20030110_20161206_01_T2",
                 "LT05_L1TP_009029_20021225_20161206_01_T1",
                 "LT05_L1TP_009029_20021123_20161206_01_T1",
                 "LT05_L1GS_009029_20021107_20161206_01_T2",
                 "LT05_L1TP_009029_20021022_20161207_01_T1",
                 "LT05_L1TP_009029_20021006_20161206_01_T1",
                 "LT05_L1TP_009029_20020920_20161207_01_T1",
                 "LT05_L1TP_009029_20020904_20161207_01_T1",
                 "LT05_L1TP_009029_20020819_20161208_01_T1",
                 "LT05_L1GS_009029_20020803_20161207_01_T2",
                 "LT05_L1GS_009029_20020718_20161207_01_T2",
                 "LT05_L1TP_009029_20020702_20161207_01_T1",
                 "LT05_L1GS_009029_20020616_20161208_01_T2",
                 "LT05_L1GS_009029_20020515_20161208_01_T2",
                 "LT05_L1TP_009029_20020208_20161209_01_T1",
                 "LT05_L1TP_009029_20020123_20161209_01_T1",
                 "LT05_L1GS_009029_20020107_20161209_01_T2",
                 "LT05_L1GS_009029_20011222_20161210_01_T2",
                 "LT05_L1TP_009029_20011206_20161210_01_T2",
                 "LT05_L1TP_009029_20011120_20161210_01_T1",
                 "LT05_L1TP_009029_20011104_20161210_01_T1",
                 "LT05_L1TP_009029_20011019_20161209_01_T1",
                 "LT05_L1TP_009029_20011003_20161210_01_T1",
                 "LT05_L1TP_009029_20010917_20161210_01_T1",
                 "LT05_L1GS_009029_20010901_20161210_01_T2",
                 "LT05_L1TP_009029_20010816_20161210_01_T1",
                 "LT05_L1TP_009029_20010731_20161210_01_T1",
                 "LT05_L1TP_009029_19991030_20161217_01_T1",
                 "LT05_L1TP_009029_19990928_20161216_01_T1",
                 "LT05_L1TP_009029_19990912_20161216_01_T1",
                 "LT05_L1TP_009029_19990827_20161216_01_T1",
                 "LT05_L1TP_009029_19990811_20161218_01_T1",
                 "LT05_L1GS_009029_19990726_20161219_01_T2",
                 "LT05_L1TP_009029_19990624_20161217_01_T1",
                 "LT05_L1GS_009029_19990608_20161217_01_T2",
                 "LT05_L1TP_009029_19990507_20161218_01_T1",
                 "LT05_L1TP_009029_19990421_20161218_01_T1",
                 "LT05_L1TP_009029_19990405_20161219_01_T1",
                 "LT05_L1TP_009029_19981027_20161220_01_T1",
                 "LT05_L1GS_009029_19981011_20161221_01_T2",
                 "LT05_L1TP_009029_19980925_20161221_01_T1",
                 "LT05_L1TP_009029_19980808_20161223_01_T1",
                 "LT05_L1TP_009029_19980723_20161223_01_T1",
                 "LT05_L1TP_009029_19980707_20161223_01_T1",
                 "LT05_L1GS_009029_19980402_20161225_01_T2",
                 "LT05_L1TP_009029_19980317_20161226_01_T1",
                 "LT05_L1TP_009029_19971008_20161229_01_T1",
                 "LT05_L1TP_009029_19970922_20161230_01_T1",
                 "LT05_L1TP_009029_19970906_20161230_01_T1",
                 "LT05_L1TP_009029_19970821_20161230_01_T1",
                 "LT05_L1GS_009029_19970618_20161231_01_T2",
                 "LT05_L1TP_009029_19970602_20161231_01_T1",
                 "LT05_L1TP_009029_19970517_20161231_01_T1",
                 "LT05_L1TP_009029_19970415_20161231_01_T1",
                 "LT05_L1GS_009029_19970330_20170101_01_T2",
                 "LT05_L1TP_009029_19961021_20170103_01_T1",
                 "LT05_L1TP_009029_19961005_20170102_01_T1",
                 "LT05_L1GS_009029_19960919_20170102_01_T2",
                 "LT05_L1GS_009029_19960903_20170103_01_T2",
                 "LT05_L1GS_009029_19960818_20170103_01_T2",
                 "LT05_L1TP_009029_19960717_20170103_01_T1",
                 "LT05_L1TP_009029_19960615_20170104_01_T1",
                 "LT05_L1GS_009029_19960530_20170104_01_T2",
                 "LT05_L1TP_009029_19960514_20170104_01_T1",
                 "LT05_L1TP_009029_19960428_20170104_01_T1",
                 "LT05_L1TP_009029_19960412_20170105_01_T1",
                 "LT05_L1TP_009029_19951019_20170106_01_T1",
                 "LT05_L1TP_009029_19951003_20170106_01_T1",
                 "LT05_L1TP_009029_19950901_20170108_01_T1",
                 "LT05_L1GS_009029_19950816_20170107_01_T2",
                 "LT05_L1TP_009029_19950731_20170108_01_T1",
                 "LT05_L1GS_009029_19950715_20170107_01_T2",
                 "LT05_L1TP_009029_19950629_20170109_01_T1",
                 "LT05_L1GS_009029_19950613_20170107_01_T2",
                 "LT05_L1TP_009029_19950528_20170109_01_T1",
                 "LT05_L1TP_009029_19950426_20170108_01_T1",
                 "LT05_L1TP_009029_19950410_20170109_01_T1",
                 "LT05_L1TP_009029_19941016_20170112_01_T1",
                 "LT05_L1GS_009029_19940728_20170113_01_T2",
                 "LT05_L1TP_009029_19940712_20170113_01_T1",
                 "LT05_L1TP_009029_19940610_20170115_01_T1",
                 "LT05_L1GS_009029_19940525_20170115_01_T2",
                 "LT05_L1GS_009029_19940509_20170114_01_T2",
                 "LT05_L1TP_009029_19940423_20170114_01_T1",
                 "LT05_L1GS_009029_19940407_20170114_01_T2",
                 "LT05_L1TP_009029_19931013_20170116_01_T1",
                 "LT05_L1TP_009029_19930911_20170117_01_T1",
                 "LT05_L1TP_009029_19930826_20170117_01_T1",
                 "LT05_L1TP_009029_19930810_20170117_01_T1",
                 "LT05_L1TP_009029_19930725_20170118_01_T1",
                 "LT05_L1TP_009029_19930522_20170119_01_T1",
                 "LT05_L1GS_009029_19930506_20170119_01_T2",
                 "LT05_L1TP_009029_19930420_20170119_01_T1",
                 "LT05_L1TP_009029_19930404_20170120_01_T1",
                 "LT05_L1TP_009029_19930319_20170120_01_T1",
                 "LT05_L1TP_009029_19921010_20170122_01_T1",
                 "LT05_L1TP_009029_19920924_20170122_01_T1",
                 "LT05_L1TP_009029_19920823_20170121_01_T1",
                 "LT05_L1TP_009029_19920807_20170122_01_T1",
                 "LT05_L1TP_009029_19920722_20170122_01_T1",
                 "LT05_L1GS_009029_19920706_20170123_01_T2",
                 "LT05_L1TP_009029_19920620_20170123_01_T1",
                 "LT05_L1TP_009029_19920604_20170122_01_T1",
                 "LT05_L1TP_009029_19920519_20170122_01_T1",
                 "LT05_L1GS_009029_19920417_20170124_01_T2",
                 "LT05_L1TP_009029_19920401_20170123_01_T1",
                 "LT05_L1TP_009029_19911024_20170125_01_T1",
                 "LT05_L1TP_009029_19911008_20170125_01_T1",
                 "LT05_L1TP_009029_19910922_20170126_01_T1",
                 "LT05_L1TP_009029_19910906_20170125_01_T2",
                 "LT05_L1GS_009029_19910821_20170126_01_T2",
                 "LT05_L1TP_009029_19910720_20170126_01_T1",
                 "LT05_L1TP_009029_19910704_20170127_01_T1",
                 "LT05_L1TP_009029_19910618_20170126_01_T1",
                 "LT05_L1TP_009029_19910602_20170127_01_T1",
                 "LT05_L1TP_009029_19910517_20170126_01_T1",
                 "LT05_L1TP_009029_19910415_20170128_01_T1",
                 "LT05_L1GS_009029_19910330_20170127_01_T2",
                 "LT05_L1TP_009029_19901021_20170128_01_T1",
                 "LT05_L1TP_009029_19901005_20170128_01_T1",
                 "LT05_L1TP_009029_19900919_20170128_01_T1",
                 "LT05_L1TP_009029_19900903_20170129_01_T1",
                 "LT05_L1TP_009029_19900802_20170129_01_T1",
                 "LT05_L1GS_009029_19900701_20170129_01_T2",
                 "LT05_L1TP_009029_19900412_20170131_01_T1",
                 "LT05_L1GS_009029_19891018_20170201_01_T2",
                 "LT05_L1TP_009029_19890916_20170201_01_T1",
                 "LT05_L1TP_009029_19890831_20170201_01_T1",
                 "LT05_L1TP_009029_19890815_20170202_01_T1",
                 "LT05_L1TP_009029_19890730_20170202_01_T1",
                 "LT05_L1TP_009029_19890612_20170203_01_T1",
                 "LT05_L1TP_009029_19890527_20170203_01_T1",
                 "LT05_L1TP_009029_19890425_20170203_01_T1",
                 "LT05_L1TP_009029_19890409_20170204_01_T1",
                 "LT05_L1TP_009029_19890324_20170204_01_T1",
                 "LT05_L1TP_009029_19881015_20170205_01_T1",
                 "LT05_L1TP_009029_19880929_20170206_01_T1",
                 "LT05_L1TP_009029_19880812_20170207_01_T1",
                 "LT05_L1GS_009029_19880625_20170208_01_T2",
                 "LT05_L1TP_009029_19880508_20170208_01_T1",
                 "LT05_L1TP_009029_19871013_20170210_01_T1",
                 "LT05_L1TP_009029_19870927_20170211_01_T1",
                 "LT05_L1TP_009029_19870911_20170211_01_T2",
                 "LT05_L1TP_009029_19870725_20170211_01_T1",
                 "LT05_L1GS_009029_19870709_20170212_01_T2",
                 "LT05_L1TP_009029_19870607_20170212_01_T1",
                 "LT05_L1GS_009029_19870506_20170213_01_T2",
                 "LT05_L1TP_009029_19870404_20170213_01_T1",
                 "LT05_L1TP_009029_19870114_20170215_01_T1",
                 "LT05_L1TP_009029_19861229_20170215_01_T1",
                 "LT05_L1TP_009029_19861213_20170215_01_T1",
                 "LT05_L1TP_009029_19861026_20170216_01_T1",
                 "LT05_L1GS_009029_19860924_20170216_01_T2",
                 "LT05_L1TP_009029_19860823_20170216_01_T1",
                 "LT05_L1TP_009029_19860807_20170217_01_T1",
                 "LT05_L1TP_009029_19860519_20170217_01_T1",
                 "LT05_L1TP_009029_19860417_20170218_01_T1",
                 "LT05_L1TP_009029_19860401_20170218_01_T1",
                 "LT05_L1GS_009029_19860316_20170218_01_T2",
                 "LT05_L1TP_009029_19860228_20170218_01_T1",
                 "LT05_L1TP_009029_19860111_20170218_01_T1",
                 "LT05_L1TP_009029_19851210_20170218_01_T1",
                 "LT05_L1GS_009029_19851124_20170218_01_T2",
                 "LT05_L1TP_009029_19851023_20170218_01_T1",
                 "LT05_L1TP_009029_19851007_20170218_01_T1",
                 "LT05_L1TP_009029_19850921_20170218_01_T1",
                 "LT05_L1GS_009029_19850703_20170219_01_T2",
                 "LT05_L1GS_009029_19850617_20170219_01_T2",
                 "LT05_L1TP_009029_19850516_20170219_01_T1",
                 "LT05_L1TP_009029_19850414_20170219_01_T1",
                 "LT05_L1TP_009029_19850329_20170219_01_T1",
                 "LT05_L1GS_009029_19850225_20170219_01_T2",
                 "LT05_L1TP_009029_19850124_20170219_01_T1",
                 "LT05_L1GS_009029_19850108_20170219_01_T2",
                 "LT05_L1GS_009029_19841207_20170219_01_T2",
                 "LT05_L1GS_009029_19841121_20170220_01_T2",
                 "LT05_L1TP_009029_19840918_20170220_01_T1",
                 "LT05_L1TP_009029_19840902_20170220_01_T1",
                 "LT05_L1TP_009029_19840716_20170220_01_T1",
                 "LT05_L1GS_009029_19840630_20170220_01_T2",
                 "LT05_L1GS_009029_19840614_20170220_01_T2",
                 "LT05_L1TP_009029_19840427_20170220_01_T1",
                 "LT05_L1GS_009029_19840411_20170220_01_T2",
                 "LT05_L1TP_009029_19840328_20170220_01_T1",
                 "LT04_L1TP_009029_19830127_20170220_01_T1",
                 "LT04_L1GS_009029_19821226_20170220_01_T2",
                 "LT04_L1TP_009029_19821210_20170220_01_T1",
                 "LT05_L1TP_063013_19960711_20170104_01_T1", # these are from Kevin's LANDSAT R tutorial
                 "LT05_L1TP_065013_19920628_20160929_01_T1",
                 "LT05_L1TP_064013_19910705_20170126_01_T1")

archive_files <- file.path("dummy_directory",
                           paste0(product_ids, ".tar.gz"))

image_files <- with(expand.grid(band = c(paste0("B", 1:11), "BQA"), fn = product_ids), {
  file.path("dummy_directory_2", paste0(fn, "_", band, ".TIF"))
})


test_that("parsing functions generate the correct dimensions of output", {
  # zero-length input
  pid0 <- landsat_parse_product_id(character(0))
  expect_is(pid0, "data.frame")
  expect_equal(nrow(pid0), 0L)
  arc0 <- landsat_parse_filename_archive(character(0))
  expect_is(arc0, "data.frame")
  expect_equal(nrow(arc0), 0L)
  img0 <- landsat_parse_filename_image(character(0))
  expect_is(img0, "data.frame")
  expect_equal(nrow(img0), 0L)

  # one-length input
  pid1 <- landsat_parse_product_id("LT05_L1TP_063013_19960711_20170104_01_T1")
  expect_is(pid1, "data.frame")
  expect_identical(nrow(pid1), 1L)
  arc1 <- landsat_parse_filename_archive("LT05_L1TP_063013_19960711_20170104_01_T1.tar.gz")
  expect_is(arc1, "data.frame")
  expect_identical(nrow(arc1), 1L)
  img1 <- landsat_parse_filename_image("LT05_L1TP_063013_19960711_20170104_01_T1_B1.TIF")
  expect_is(img1, "data.frame")
  expect_identical(nrow(img1), 1L)

  # expect product ID columns are all valid product IDs
  expect_true(all(grepl(landsatutils:::landsat_product_id_regex, pid1$product_id)))
  expect_true(all(grepl(landsatutils:::landsat_product_id_regex, arc1$product_id)))
  expect_true(all(grepl(landsatutils:::landsat_product_id_regex, img1$product_id)))

  # n-length input
  pidN <- landsat_parse_product_id(product_ids)
  expect_is(pidN, "data.frame")
  expect_identical(nrow(pidN), length(product_ids))
  arcN <- landsat_parse_filename_archive(archive_files)
  expect_is(arcN, "data.frame")
  expect_identical(nrow(arcN), length(archive_files))
  imgN <- landsat_parse_filename_image(image_files)
  expect_is(imgN, "data.frame")
  expect_identical(nrow(imgN), length(image_files))

  # expect product ID columns are all valid product IDs
  expect_true(all(grepl(landsatutils:::landsat_product_id_regex, pidN$product_id)))
  expect_true(all(grepl(landsatutils:::landsat_product_id_regex, arcN$product_id)))
  expect_true(all(grepl(landsatutils:::landsat_product_id_regex, imgN$product_id)))
})

test_that("parsing invalid product IDs generates an error", {
  expect_is(landsat_parse_product_id("LT05_L1TP_063013_19960711_20170104_01_T1"),
            "data.frame")
  expect_is(landsat_parse_product_id("LT05_L1TP_063013_19960711_20170104_01_T1_B1.TIF"),
            "data.frame")
  expect_is(landsat_parse_product_id("LT05_L1TP_063013_19960711_20170104_01_T1.tar.gz"),
            "data.frame")

  # make sure error message is case sensitive
  expect_error(landsat_parse_product_id("not a product ID"),
               "The following filenames do not contain valid Landsat product IDs: not a product ID")

  # make sure error is thrown if any values are NA
  expect_error(landsat_parse_product_id(NA_character_),
               "The following filenames do not contain valid Landsat product IDs: NA")
})

test_that("parsing invalid archive filenames generates an error", {
  expect_error(landsat_parse_filename_archive("LT05_L1TP_063013_19960711_20170104_01_T1"),
               "The following filenames are not valid Landsat archive filenames:*")
  expect_error(landsat_parse_filename_archive("LT05_L1TP_063013_19960711_20170104_01_T1_B1.TIF"),
               "The following filenames are not valid Landsat archive filenames:*")
  expect_is(landsat_parse_filename_archive("LT05_L1TP_063013_19960711_20170104_01_T1.tar.gz"),
            "data.frame")

  # make sure error message is case sensitive
  expect_error(landsat_parse_filename_archive("not a product ID"),
               "The following filenames are not valid Landsat archive filenames: not a product ID")

  # make sure error is thrown if any values are NA
  expect_error(landsat_parse_filename_archive(NA_character_),
               "The following filenames are not valid Landsat archive filenames: NA")
})

test_that("parsing invalid image filenames generates an error", {
  expect_error(landsat_parse_filename_image("LT05_L1TP_063013_19960711_20170104_01_T1"),
               "The following filenames are not valid Landsat image filenames:*")
  expect_is(landsat_parse_filename_image("LT05_L1TP_063013_19960711_20170104_01_T1_B1.TIF"),
            "data.frame")
  expect_error(landsat_parse_filename_image("LT05_L1TP_063013_19960711_20170104_01_T1.tar.gz"),
               "The following filenames are not valid Landsat image filenames:*")

  # make sure error message is case sensitive
  expect_error(landsat_parse_filename_image("not a product ID"),
               "The following filenames are not valid Landsat image filenames: not a product ID")

  # make sure error is thrown if any values are NA
  expect_error(landsat_parse_filename_image(NA_character_),
               "The following filenames are not valid Landsat image filenames: NA")
})
